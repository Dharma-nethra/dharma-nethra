<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‡∂∞‡∂ª‡∑ä‡∂∏ ‡∂±‡∑ö‡∂≠‡∑ä‚Äç‡∂ª‡∑è - Dharma Nethra</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Sinhala:wght@400;600;700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <style>
        :root {
            --primary-color: #d35400;
            --primary-dark: #a04000;
            --accent-color: #8e44ad;
            --bg-light: #f4f7f6;
            --text-light: #2d3436;
            --card-light: #ffffff;
            --shadow-light: 0 10px 30px rgba(0,0,0,0.08);
            --read-color: #27ae60;
        }
        .dark-mode {
            --bg-light: #121212;
            --text-light: #e0e0e0;
            --card-light: #1e1e1e;
            --shadow-light: 0 10px 30px rgba(0,0,0,0.3);
            --primary-color: #e67e22;
        }
        * {
            user-select: none;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            font-family: 'Noto Sans Sinhala', 'Poppins', sans-serif;
        }
        body {
            background-color: var(--bg-light);
            color: var(--text-light);
            transition: all 0.4s ease;
            margin: 0;
            padding-bottom: 130px;
            overflow-x: hidden;
        }
        /* ‡∂Ö‡∂Ω‡∂Ç‡∂ö‡∑è‡∂ª Header ‡∂ë‡∂ö */
        .header {
            background: var(--card-light);
            padding: 25px 20px;
            text-align: center;
            box-shadow: var(--shadow-light);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom-left-radius: 30px;
            border-bottom-right-radius: 30px;
        }
        .app-name {
            font-size: 32px;
            font-weight: 800;
            background: linear-gradient(45deg, var(--primary-color), var(--accent-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 5px;
        }
        .slogan {
            font-size: 14px;
            font-style: italic;
            opacity: 0.8;
            margin-bottom: 15px;
        }
        .clock-card {
            background: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
            padding: 15px;
            border-radius: 20px;
            color: #fff;
            text-shadow: 0 2px 5px rgba(0,0,0,0.2);
            margin: 15px auto;
            max-width: 300px;
        }
        .dark-mode .clock-card { background: linear-gradient(135deg, #434343 0%, #000000 100%); }
        .clock { font-size: 28px; font-weight: 700; }
        .date { font-size: 15px; font-weight: 600; }
        
        /* ‡∂±‡∑Ä‡∑ì‡∂± ‡∂∂‡∑ú‡∂≠‡∑ä‡∂≠‡∂∏‡∑ä */
        .btn {
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            cursor: pointer;
            background: linear-gradient(45deg, var(--primary-color), var(--primary-dark));
            color: white;
            margin: 8px;
            font-weight: 600;
            font-size: 15px;
            box-shadow: 0 5px 15px rgba(211, 84, 0, 0.3);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .btn:active { transform: scale(0.96); box-shadow: 0 2px 5px rgba(211, 84, 0, 0.3); }
        .btn-secondary { background: linear-gradient(45deg, #7f8c8d, #95a5a6); box-shadow: 0 5px 15px rgba(127, 140, 141, 0.3); }
        .btn-accent { background: linear-gradient(45deg, var(--accent-color), #9b59b6); box-shadow: 0 5px 15px rgba(142, 68, 173, 0.3); }
        .btn-whatsapp { background: linear-gradient(45deg, #25D366, #128C7E); box-shadow: 0 5px 15px rgba(37, 211, 102, 0.3); }
        
        .container { padding: 20px; max-width: 700px; margin: auto; }
        
        /* ‡∂Ö‡∂Ω‡∂Ç‡∂ö‡∑è‡∂ª ‡∂ö‡∑è‡∂©‡∑ä‡∂¥‡∂≠‡∑ä */
        .article-card {
            background: var(--card-light);
            padding: 25px;
            border-radius: 25px;
            margin-bottom: 25px;
            box-shadow: var(--shadow-light);
            position: relative;
            transition: transform 0.3s ease;
            border: 1px solid rgba(0,0,0,0.05);
        }
        .article-card:hover { transform: translateY(-5px); }
        .title { font-size: 22px; font-weight: 800; color: var(--primary-color); margin-bottom: 12px; line-height: 1.3; }
        .snippet { font-size: 16px; line-height: 1.6; opacity: 0.9; }
        .read-badge { position: absolute; top: 20px; right: 20px; background: var(--read-color); color: white; padding: 5px 12px; border-radius: 20px; font-size: 11px; font-weight: 700; box-shadow: 0 3px 10px rgba(39, 174, 96, 0.3); }
        
        /* Bottom Navigation Bar */
        .bottom-nav {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 500px;
            background: var(--card-light);
            display: flex;
            justify-content: space-around;
            padding: 15px 10px;
            border-radius: 30px;
            z-index: 1000;
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
            border: 1px solid rgba(255,255,255,0.1);
        }
        .nav-item {
            text-align: center;
            font-size: 10px;
            cursor: pointer;
            color: var(--text-light);
            opacity: 0.6;
            transition: 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .nav-icon { font-size: 24px; margin-bottom: 5px; }
        .nav-item.active { opacity: 1; color: var(--primary-color); transform: scale(1.1); }
        .hidden { display: none; }
        input, textarea { width: 100%; padding: 15px; margin: 15px 0; border-radius: 15px; border: 2px solid rgba(0,0,0,0.1); font-size: 16px; background: var(--bg-light); color: var(--text-light); transition: 0.3s; }
        input:focus, textarea:focus { border-color: var(--primary-color); outline: none; }
        .merit-item { background: linear-gradient(to right, #fff3e0, var(--card-light)); padding: 15px 20px; border-radius: 15px; margin-bottom: 15px; position: relative; border-left: 6px solid var(--primary-color); box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        #timer-display { font-size: 60px; text-align: center; margin: 30px 0; font-family: 'Poppins', monospace; color: var(--primary-color); font-weight: 800; text-shadow: 0 3px 10px rgba(0,0,0,0.1); }
    </style>
</head>
<body oncontextmenu="return false;">

<div class="header">
    <div class="app-name">‡∂∞‡∂ª‡∑ä‡∂∏ ‡∂±‡∑ö‡∂≠‡∑ä‚Äç‡∂ª‡∑è</div>
    <div class="slogan">"‡∂¥‡∑ä‚Äç‡∂ª‡∂•‡∑è‡∑Ä‡∑ö ‡∂Ü‡∂Ω‡∑ù‡∂ö‡∂∫ ‡∂¥‡∂≠‡∑î‡∂ª‡∑î‡∑Ä‡∂± ‡∑É‡∂Ø‡∑Ñ‡∂∏‡∑ä ‡∂Ö‡∑Ä‡∂ö‡∑è‡∑Å‡∂∫"</div>
    <div class="clock-card">
        <div class="clock" id="clock">00:00:00</div>
        <div id="date" class="date">‡∂Ø‡∑í‡∂±‡∂∫ ‡∂¥‡∑ñ‡∂ª‡∂´‡∂∫ ‡∑Ä‡∑ö...</div>
    </div>
    <button class="btn btn-secondary" onclick="toggleDarkMode()">üåô Dark Mode</button>
</div>

<div class="container" id="main-content">
    <div id="page-home">
        <div class="article-card" style="text-align:center;">
            <h3 class="title">üßò ‡∂∑‡∑è‡∑Ä‡∂±‡∑è ‡∂ö‡∑è‡∂Ω ‡∂ú‡∂´‡∂ö‡∂∫</h3>
            <div id="timer-display">10:00</div>
            <div>
                <button class="btn" onclick="startTimer()">‡∂Ü‡∂ª‡∂∏‡∑ä‡∂∑ ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</button>
                <button class="btn btn-secondary" onclick="resetTimer()">‡∂±‡∑ê‡∑Ä‡∂≠ ‡∑É‡∂ö‡∑É‡∂±‡∑ä‡∂±</button>
            </div>
        </div>
        <div id="article-list">
            <div style="text-align:center; padding:50px; opacity:0.7;">
                <img src="https://cdn-icons-png.flaticon.com/512/11637/11637866.png" width="80" style="margin-bottom:20px; filter: grayscale(100%);">
                <br>‡∑É‡∂Ø‡∑ä‡∂∞‡∂ª‡∑ä‡∂∏‡∂∫ ‡∂¥‡∑ñ‡∂ª‡∂´‡∂∫ ‡∑Ä‡∑ô‡∂∏‡∑í‡∂±‡∑ä ‡∂¥‡∑Ä‡∂≠‡∑ì...
            </div>
        </div>
    </div>

    <div id="page-detail" class="hidden">
        <button class="btn btn-secondary" onclick="showPage('page-home')">‚¨ÖÔ∏è ‡∂Ü‡∂¥‡∑É‡∑î</button>
        <div class="article-card">
            <h2 id="view-title" class="title" style="font-size:26px;"></h2>
            <div style="width:50px; height:4px; background:var(--primary-color); border-radius:2px; margin: 15px 0;"></div>
            <div id="view-content" style="line-height:1.8; text-align:justify; font-size:18px; opacity:0.9;"></div>
            <div style="margin-top:30px; display:flex; flex-wrap:wrap; justify-content:center; gap:15px; padding-top:20px; border-top:2px dashed rgba(0,0,0,0.1);">
                <button class="btn btn-secondary" onclick="changeFontSize(2)">A+</button>
                <button class="btn btn-secondary" onclick="changeFontSize(-2)">A-</button>
                <button class="btn btn-accent" onclick="readArt()">üîä ‡∑Å‡∑ä‚Äç‡∂ª‡∑Ä‡∂´‡∂∫ ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</button>
                <button class="btn btn-whatsapp" onclick="shareWhatsApp()">üí¨ WhatsApp</button>
            </div>
            <div style="display:flex; justify-content: space-between; margin-top:30px;">
                <button class="btn btn-secondary" style="padding:10px 20px; font-size:13px;" onclick="navArt(-1)">‚¨ÖÔ∏è ‡∂¥‡∑ô‡∂ª ‡∂Ω‡∑í‡∂¥‡∑í‡∂∫</button>
                <button class="btn btn-secondary" style="padding:10px 20px; font-size:13px;" onclick="navArt(1)">‡∂∏‡∑ì‡∑Ö‡∂ü ‡∂Ω‡∑í‡∂¥‡∑í‡∂∫ ‚û°Ô∏è</button>
            </div>
        </div>
    </div>

    <div id="page-merit" class="hidden">
        <div class="article-card">
            <h2 class="title" style="text-align:center;">üìñ ‡∂¥‡∑í‡∂Ç ‡∂¥‡∑ú‡∂≠</h2>
            <input type="date" id="merit-date">
            <textarea id="merit-text" rows="4" placeholder="‡∂î‡∂∂ ‡∂ö‡∑Ö ‡∂ã‡∂≠‡∑î‡∂∏‡∑ä ‡∂¥‡∑í‡∂±‡∑ä‡∂ö‡∂∏ ‡∂∏‡∑ô‡∑Ñ‡∑í ‡∑É‡∂ß‡∑Ñ‡∂±‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±..."></textarea>
            <button class="btn" style="width:100%; font-size:18px;" onclick="addMerit()">‡∑É‡∂ß‡∑Ñ‡∂±‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</button>
        </div>
        <div id="merit-list"></div>
    </div>

    <div id="page-donate" class="hidden">
        <div class="article-card" style="text-align:center;">
            <span style="font-size:50px;">üôè</span>
            <h2 class="title">‡∂Ü‡∂∞‡∑è‡∂ª (Support Us)</h2>
            <p style="opacity:0.8;">‡∂∞‡∂ª‡∑ä‡∂∏ ‡∂¥‡∑ä‚Äç‡∂ª‡∂†‡∑è‡∂ª‡∂ö ‡∂ö‡∂ß‡∂∫‡∑î‡∂≠‡∑î ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂Ø‡∑è‡∂∫‡∂ö ‡∑Ä‡∂±‡∑ä‡∂±.</p>
            <div style="background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%); padding:25px; border-radius:20px; margin:25px 0; box-shadow: 0 10px 20px rgba(230, 126, 34, 0.2); color:#d35400; text-align:left;">
                <h3 style="margin-top:0;">üèõÔ∏è ‡∂∂‡∑ê‡∂Ç‡∂ö‡∑î ‡∑Ä‡∑í‡∑É‡∑ä‡∂≠‡∂ª:</h3>
                <p style="margin:5px 0;"><b>‡∂∂‡∑ê‡∂Ç‡∂ö‡∑î‡∑Ä:</b> ‡∂Ω‡∂Ç‡∂ö‡∑è ‡∂∂‡∑ê‡∂Ç‡∂ö‡∑î‡∑Ä</p>
                <p style="margin:5px 0;"><b>‡∂ú‡∑í‡∂´‡∑î‡∂∏‡∑ä ‡∂±‡∑è‡∂∏‡∂∫:</b> ‡∂∞‡∂ª‡∑ä‡∂∏ ‡∂±‡∑ö‡∂≠‡∑ä‚Äç‡∂ª‡∑è ‡∂Ö‡∂ª‡∂∏‡∑î‡∂Ø‡∂Ω</p>
                <p style="margin:5px 0; font-size:18px;"><b>‡∂ú‡∑í‡∂´‡∑î‡∂∏‡∑ä ‡∂Ö‡∂Ç‡∂ö‡∂∫:</b> 1234567890</p>
                <p style="margin:5px 0;"><b>‡∑Å‡∑è‡∂õ‡∑è‡∑Ä:</b> ‡∂ö‡∑ú‡∑Ö‡∂π</p>
            </div>
            <button class="btn btn-whatsapp" style="width:100%; font-size:16px;" onclick="window.open('https://wa.me/94771234567?text=Donation Receipt')">üí¨ WhatsApp ‡∂ª‡∑í‡∑É‡∑í‡∂ß‡∑ä‡∂¥‡∂≠ ‡∂ë‡∑Ä‡∂±‡∑ä‡∂±</button>
        </div>
    </div>

    <div id="page-about" class="hidden">
        <div class="article-card">
            <div style="text-align:center;"><span style="font-size:50px;">üßò</span></div>
            <h2 class="title" style="text-align:center;">‡∑É‡∑ä‡∑Ä‡∑è‡∂∏‡∑ì‡∂±‡∑ä ‡∑Ä‡∑Ñ‡∂±‡∑ä‡∑É‡∑ö ‡∂¥‡∑í‡∑Ö‡∑í‡∂∂‡∂≥‡∑Ä</h2>
            <p style="text-align:justify; opacity:0.9;">‡∂¥‡∑ñ‡∂¢‡∑ä‚Äç‡∂∫ [‡∂î‡∂∂ ‡∑Ä‡∑Ñ‡∂±‡∑ä‡∑É‡∑ö‡∂ú‡∑ö ‡∂±‡∂∏] ‡∑É‡∑ä‡∑Ä‡∑è‡∂∏‡∑ì‡∂±‡∑ä ‡∑Ä‡∑Ñ‡∂±‡∑ä‡∑É‡∑ö ‡∑Ä‡∑í‡∑É‡∑í‡∂±‡∑ä ‡∂Ω‡∑ù‡∂ö‡∑Ä‡∑è‡∑É‡∑ì ‡∑É‡∑ê‡∂Ø‡∑ê‡∑Ñ‡∑ê‡∑Ä‡∂≠‡∑î‡∂±‡∑ä‡∂ú‡∑ö ‡∂¥‡∑ä‚Äç‡∂ª‡∂•‡∑è‡∑Ä ‡∂Ö‡∑Ä‡∂Ø‡∑í ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏ ‡∂ã‡∂Ø‡∑ô‡∑É‡∑è ‡∂∏‡∑ô‡∂∏ ‡∂ã‡∂≠‡∑î‡∂∏‡∑ä ‡∑É‡∂Ø‡∑ä‡∂∞‡∂ª‡∑ä‡∂∏ ‡∑É‡∑ö‡∑Ä‡∑è‡∑Ä ‡∂¥‡∑Ä‡∂≠‡∑ä‡∑Ä‡∑è‡∂ú‡∑ô‡∂± ‡∂∫‡∂±‡∑î ‡∂Ω‡∂∂‡∂∫‡∑í.</p>
        </div>
        <div class="article-card">
             <div style="text-align:center;"><span style="font-size:50px;">üèõÔ∏è</span></div>
            <h2 class="title" style="text-align:center;">‡∂Ü‡∂∫‡∂≠‡∂±‡∂∫ ‡∂¥‡∑í‡∑Ö‡∑í‡∂∂‡∂≥‡∑Ä</h2>
            <p style="text-align:justify; opacity:0.9;">'‡∂∞‡∂ª‡∑ä‡∂∏ ‡∂±‡∑ö‡∂≠‡∑ä‚Äç‡∂ª‡∑è' ‡∂∫‡∂±‡∑î ‡∂±‡∑Ä‡∑ì‡∂± ‡∂≠‡∑è‡∂ö‡∑ä‡∑Ç‡∂´‡∂∫ ‡∂∏‡∑î‡∑É‡∑î ‡∂ö‡∑ú‡∂ß ‡∂¥‡∑í‡∂ª‡∑í‡∑É‡∑í‡∂Ø‡∑î ‡∂∂‡∑î‡∂Ø‡∑î ‡∂Ø‡∑Ñ‡∂∏ ‡∂Ω‡∑ú‡∑Ä‡∂ß ‡∂∂‡∑ô‡∂Ø‡∑è ‡∂Ø‡∑ô‡∂± ‡∂Ω‡∑è‡∂∑ ‡∂±‡∑ú‡∂Ω‡∂∂‡∂± ‡∂∞‡∂ª‡∑ä‡∂∏ ‡∑è‡∂∫‡∂≠‡∂±‡∂∫‡∂ö‡∑í.</p>
        </div>
    </div>

    <div id="page-contact" class="hidden">
        <div class="article-card" style="text-align:center;">
            <h2 class="title">üìû ‡∑É‡∂∏‡∑ä‡∂∂‡∂±‡∑ä‡∂∞ ‡∑Ä‡∂±‡∑ä‡∂±</h2>
            <p style="opacity:0.8; margin-bottom:30px;">‡∂Ö‡∂¥ ‡∑Ñ‡∑è ‡∑É‡∂∏‡∑ä‡∂∂‡∂±‡∑ä‡∂∞ ‡∑Ä‡∑ì‡∂∏‡∂ß ‡∂¥‡∑Ñ‡∂≠ ‡∂ö‡∑ä‚Äç‡∂ª‡∂∏ ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∑è ‡∂ö‡∂ª‡∂±‡∑ä‡∂±.</p>
            <button class="btn" style="width:100%; margin:10px 0; background: linear-gradient(45deg, #3498db, #2980b9);" onclick="location.href='tel:+94771234567'">üìû ‡∂Ö‡∂∏‡∂≠‡∂±‡∑ä‡∂±: +94 77 123 4567</button>
            <button class="btn btn-whatsapp" style="width:100%; margin:10px 0;" onclick="window.open('https://wa.me/94771234567')">üí¨ WhatsApp ‡∂¥‡∂´‡∑í‡∑Ä‡∑í‡∂©‡∂∫‡∂ö‡∑ä</button>
            <button class="btn btn-secondary" style="width:100%; margin:10px 0;" onclick="location.href='mailto:info@dharmanethra.lk'">üìß ‡∑Ä‡∑í‡∂Ø‡∑ä‚Äç‡∂∫‡∑î‡∂≠‡∑ä ‡∂Ω‡∑í‡∂¥‡∑í‡∂∫: info@dharmanethra.lk</button>
        </div>
    </div>
</div>

<div class="bottom-nav">
    <div class="nav-item active" onclick="showPage(this, 'page-home')"><span class="nav-icon">üè†</span>‡∂∏‡∑î‡∂Ω‡∑ä ‡∂¥‡∑í‡∂ß‡∑î‡∑Ä</div>
    <div class="nav-item" onclick="showPage(this, 'page-fav')"><span class="nav-icon">‚ù§Ô∏è</span>‡∂¥‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∂≠‡∂∏</div>
    <div class="nav-item" onclick="showPage(this, 'page-merit')"><span class="nav-icon">üìñ</span>‡∂¥‡∑í‡∂Ç ‡∂¥‡∑ú‡∂≠</div>
    <div class="nav-item" onclick="showPage(this, 'page-donate')"><span class="nav-icon">üôè</span>‡∂Ü‡∂∞‡∑è‡∂ª</div>
    <div class="nav-item" onclick="showPage(this, 'page-about')"><span class="nav-icon">‚ÑπÔ∏è</span>‡∂Ö‡∂¥ ‡∂ú‡∑ê‡∂±</div>
    <div class="nav-item" onclick="showPage(this, 'page-contact')"><span class="nav-icon">üìû</span>‡∑É‡∂∏‡∑ä‡∂∂‡∂±‡∑ä‡∂∞</div>
</div>

<audio id="bell" src="https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3"></audio>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyDEiwhtAIdoqdMIV5n_bdDoKuIrCkjqr3M",
        authDomain: "dharma-nethra.firebaseapp.com",
        projectId: "dharma-nethra",
        storageBucket: "dharma-nethra.firebasestorage.app",
        messagingSenderId: "365410669829",
        appId: "1:365410669829:web:d9a9465ed1f1f2b792936c"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    let articles = []; let curIdx = 0;
    let favs = JSON.parse(localStorage.getItem('f')) || [];
    let reads = JSON.parse(localStorage.getItem('r')) || [];
    let merits = JSON.parse(localStorage.getItem('m')) || [];
    let fSize = 18;

    function tick() {
        const now = new Date();
        document.getElementById('clock').innerText = now.toLocaleTimeString('si-LK');
        document.getElementById('date').innerText = now.toLocaleDateString('si-LK', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
    } setInterval(tick, 1000);

    async function getArts() {
        const snap = await db.collection("articles").get();
        articles = snap.docs.map(doc => doc.data());
        draw(articles);
    }

    function draw(data) {
        const list = document.getElementById('article-list');
        list.innerHTML = data.map((a, i) => `
            <div class="article-card" onclick="openArt(${i})">
                ${reads.includes(a.id) ? '<span class="read-badge">‚úÖ ‡∂ö‡∑í‡∂∫‡∑Ä‡∂± ‡∂Ω‡∂Ø‡∑ì</span>' : ''}
                <div class="title">${a.title}</div>
                <div class="snippet">${a.snippet}</div>
                <div style="margin-top:15px; display:flex; justify-content:space-between; align-items:center;">
                    <span style="font-size:14px; opacity:0.6;">‡∂ö‡∑í‡∂∫‡∑Ä‡∑ì‡∂∏‡∂ß ‡∂≠‡∂ß‡∑ä‡∂ß‡∑î ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
                    <span style="font-size:24px; color:var(--primary-color);" onclick="event.stopPropagation(); toggleFav('${a.id}')">
                        ${favs.includes(a.id) ? 'üíñ' : '‚ù§Ô∏è'}
                    </span>
                </div>
            </div>
        `).join('');
    }

    function openArt(i) {
        curIdx = i; const a = articles[i];
        if(!reads.includes(a.id)) { reads.push(a.id); localStorage.setItem('r', JSON.stringify(reads)); }
        showPage(null, 'page-detail');
        document.getElementById('view-title').innerText = a.title;
        document.getElementById('view-content').innerText = a.content;
        document.getElementById('view-content').style.fontSize = fSize + 'px';
    }

    function showPage(el, id) {
        const p = ['page-home', 'page-detail', 'page-merit', 'page-donate', 'page-about', 'page-contact'];
        p.forEach(x => document.getElementById(x).classList.add('hidden'));
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        
        if(id === 'page-fav') {
            document.getElementById('page-home').classList.remove('hidden');
            draw(articles.filter(x => favs.includes(x.id)));
            if(el) el.classList.add('active');
        } else if (id !== 'page-detail') {
            document.getElementById(id).classList.remove('hidden');
            if(id === 'page-home') draw(articles);
            if(id === 'page-merit') drawMerits();
            if(el) el.classList.add('active');
        } else {
             document.getElementById(id).classList.remove('hidden');
        }
        window.scrollTo(0,0);
    }

    function toggleDarkMode() { document.body.classList.toggle('dark-mode'); }
    function changeFontSize(v) { fSize += v; document.getElementById('view-content').style.fontSize = fSize + 'px'; }
    function readArt() { window.speechSynthesis.cancel(); let u = new SpeechSynthesisUtterance(document.getElementById('view-content').innerText); u.lang='si-LK'; window.speechSynthesis.speak(u); }
    function shareWhatsApp() { const t = articles[curIdx].title; window.open(`https://wa.me/94771234567?text=${encodeURIComponent(`‡∂ú‡∑û‡∂ª‡∑Ä‡∂±‡∑ì‡∂∫ ‡∑É‡∑ä‡∑Ä‡∑è‡∂∏‡∑í‡∂±‡∑ä ‡∑Ä‡∑Ñ‡∂±‡∑ä‡∑É, '${t}' ‡∂Ω‡∑í‡∂¥‡∑í‡∂∫ ‡∂¥‡∑í‡∑Ö‡∑í‡∂∂‡∂≥‡∑Ä‡∂∫‡∑í:\n\n`)}`); }
    function toggleFav(id) { favs = favs.includes(id) ? favs.filter(x => x !== id) : [...favs, id]; localStorage.setItem('f', JSON.stringify(favs)); draw(articles); }
    function navArt(v) { let n = curIdx + v; if(n >= 0 && n < articles.length) openArt(n); }

    function addMerit() {
        const d = document.getElementById('merit-date').value; const t = document.getElementById('merit-text').value;
        if(d && t) { merits.unshift({ d, t, id: Date.now() }); localStorage.setItem('m', JSON.stringify(merits)); drawMerits(); document.getElementById('merit-text').value = ""; }
    }
    function drawMerits() {
        document.getElementById('merit-list').innerHTML = merits.map(m => `
            <div class="article-card merit-item">
                <div style="font-weight:bold; color:var(--primary-color);">${m.d}</div>
                <div style="font-size:16px; margin-top:5px;">${m.t}</div>
                <span style="position:absolute; right:20px; top:20px; cursor:pointer; font-size:20px;" onclick="delMerit(${m.id})">üóëÔ∏è</span>
            </div>
        `).join('');
    }
    function delMerit(id) { merits = merits.filter(x => x.id !== id); localStorage.setItem('m', JSON.stringify(merits)); drawMerits(); }

    let t_int;
    function startTimer() {
        let s = 600; clearInterval(t_int);
        t_int = setInterval(() => { s--; let m=Math.floor(s/60), sec=s%60; document.getElementById('timer-display').innerText = `${m}:${sec<10?'0'+sec:sec}`; if(s<=0) { clearInterval(t_int); document.getElementById('bell').play(); alert("‡∂∑‡∑è‡∑Ä‡∂±‡∑è ‡∂ö‡∑è‡∂Ω‡∂∫ ‡∂Ö‡∑Ä‡∑É‡∂±‡∑ä!"); } }, 1000);
    }
    function resetTimer() { clearInterval(t_int); document.getElementById('timer-display').innerText = "10:00"; }

    window.onload = () => { tick(); getArts(); document.getElementById('merit-date').valueAsDate = new Date(); };
</script>
</body>
</html>